<!doctype html>
<html lang="pt">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Jogo da EN2 ‚Äî A Grande Travessia de Portugal</title>

<style>
:root{
  --bg:#111;--text:#eee;--panel:#1c1c1c;
  --accent:#ff9800;--grey:#555;--green:#2ecc71;--red:#e53935;
}
body{margin:0;background:var(--bg);color:var(--text);font-family:Arial}
h1{text-align:center;margin:20px 0}
.main{display:flex;justify-content:center;gap:24px;align-items:flex-start}

/* TABULEIRO */
.board-frame{width:1000px;height:750px;position:relative;overflow:hidden;border-radius:10px}
.board-img{position:absolute;inset:0;background:url("https://i.imgur.com/SgYhoY8.png") center/cover no-repeat}
.pawn{position:absolute;transform:translate(-50%,-50%);font-size:22px;pointer-events:none;display:none}

/* CONTROLOS */
.controls{text-align:center;margin:20px}
button{border:none;padding:10px 18px;border-radius:10px;font-weight:bold;cursor:pointer}
button:disabled{opacity:.5}
.hidden{display:none}

/* BOT√ïES PE√ïES */
.car{background:#e53935;color:#fff}
.bike{background:#fb8c00;color:#fff}
.moto{background:#222;color:#fff}
.walk{background:#2ecc71;color:#000}

/* OBJETIVOS */
#objectivePanel{
  width:300px;background:var(--panel);
  border-radius:16px;padding:12px;
  border:2px dashed #555;
}
.objective-title{color:var(--accent);font-weight:bold;margin-bottom:10px}
.obj-item{display:flex;gap:10px;margin-bottom:6px}
.marco{
  background:var(--grey);color:#fff;
  padding:4px 10px;border-radius:8px;
  min-width:64px;text-align:center;font-weight:bold
}
.marco.done{background:var(--green)}
.extra-title{
  margin:16px 0 8px 0;
  text-align:center;color:#bbb;font-size:13px;
  border-top:1px dashed #444;padding-top:8px;
}

/* MODAL */
#modal{
  position:fixed;inset:0;
  background:rgba(0,0,0,.55);
  display:none;align-items:center;justify-content:center
}
#modalBox{
  background:#222;padding:22px;
  border-radius:14px;width:420px;text-align:center
}
#modalBox button{margin:6px}
.accept{background:var(--green);color:#000}
.decline{background:var(--red);color:#fff}
.eventGood{background:#1b5e20;color:#fff}
.eventBad{background:#b71c1c;color:#fff}
</style>
</head>

<body>

<h1>Jogo da EN2 ‚Äî A Grande Travessia de Portugal</h1>

<div class="main">
  <div class="board-frame" id="board">
    <div class="board-img"></div>
    <div class="pawn" id="pawn0">üöó</div>
    <div class="pawn" id="pawn1">üö¥</div>
    <div class="pawn" id="pawn2">üèçÔ∏è</div>
    <div class="pawn" id="pawn3">üö∂</div>
  </div>
  <div id="objectivePanel" class="hidden"></div>
</div>

<div class="controls">
  <div id="setup">
    Jogadores:
    <select id="playerCount">
      <option>1</option><option>2</option><option>3</option><option>4</option>
    </select>
    <button id="startBtn">COME√áAR</button>
  </div>

  <div id="names" class="hidden"></div>

  <div id="game" class="hidden">
    <button id="rollBtn">JOGAR</button>
    üé≤ <span id="dice">‚Äî</span>
    <p id="turn"></p>
  </div>
</div>

<div id="modal">
  <div id="modalBox">
    <p id="modalText"></p>
    <div id="modalButtons"></div>
  </div>
</div>

<script>
/* ================= SPACES ================= */
const SPACES = [
{"x":0.09,"y":0.11},{"x":0.09,"y":0.16},{"x":0.09,"y":0.21},{"x":0.09,"y":0.27},
{"x":0.13,"y":0.24},{"x":0.15,"y":0.19},{"x":0.18,"y":0.14},{"x":0.22,"y":0.11},
{"x":0.27,"y":0.09},{"x":0.31,"y":0.10},{"x":0.35,"y":0.13},{"x":0.36,"y":0.18},
{"x":0.32,"y":0.22},{"x":0.29,"y":0.19},{"x":0.24,"y":0.17},{"x":0.22,"y":0.22},
{"x":0.24,"y":0.27},{"x":0.23,"y":0.32},{"x":0.18,"y":0.33},{"x":0.14,"y":0.34},
{"x":0.11,"y":0.39},{"x":0.12,"y":0.44},{"x":0.16,"y":0.47},{"x":0.20,"y":0.45},
{"x":0.23,"y":0.41},{"x":0.26,"y":0.37},{"x":0.29,"y":0.33},{"x":0.33,"y":0.30},
{"x":0.38,"y":0.32},{"x":0.40,"y":0.36},{"x":0.41,"y":0.42},
{"x":0.38,"y":0.46},{"x":0.34,"y":0.49},{"x":0.30,"y":0.50},
{"x":0.25,"y":0.52},{"x":0.20,"y":0.55},{"x":0.18,"y":0.59},
{"x":0.19,"y":0.65},{"x":0.23,"y":0.67},{"x":0.28,"y":0.65},
{"x":0.32,"y":0.63},{"x":0.36,"y":0.61},{"x":0.40,"y":0.57},
{"x":0.43,"y":0.54},{"x":0.47,"y":0.50},{"x":0.49,"y":0.47},
{"x":0.52,"y":0.43},{"x":0.56,"y":0.40},{"x":0.60,"y":0.36},
{"x":0.64,"y":0.34},{"x":0.68,"y":0.32},{"x":0.73,"y":0.34},
{"x":0.74,"y":0.39},{"x":0.71,"y":0.43},{"x":0.67,"y":0.46},
{"x":0.63,"y":0.49},{"x":0.59,"y":0.51},{"x":0.55,"y":0.54},
{"x":0.53,"y":0.58},{"x":0.53,"y":0.64},{"x":0.56,"y":0.69},
{"x":0.60,"y":0.69},{"x":0.64,"y":0.67},{"x":0.67,"y":0.62},
{"x":0.70,"y":0.58},{"x":0.73,"y":0.53},{"x":0.77,"y":0.51},
{"x":0.81,"y":0.53},{"x":0.82,"y":0.59},{"x":0.79,"y":0.64},
{"x":0.75,"y":0.65},{"x":0.71,"y":0.67},{"x":0.71,"y":0.71},
{"x":0.73,"y":0.77},{"x":0.70,"y":0.82},{"x":0.66,"y":0.80},
{"x":0.61,"y":0.78},{"x":0.59,"y":0.82},{"x":0.61,"y":0.87},
{"x":0.65,"y":0.89},{"x":0.69,"y":0.89},{"x":0.74,"y":0.87},
{"x":0.78,"y":0.83},{"x":0.80,"y":0.79},{"x":0.82,"y":0.74},
{"x":0.85,"y":0.69},{"x":0.87,"y":0.75},{"x":0.89,"y":0.79},
{"x":0.91,"y":0.85},{"x":0.90,"y":0.90}
];

/* ================= OBJETIVOS ================= */
const OBJECTIVES=[
 { items:[
    {km:0,text:"Visitar Chaves"},
    {km:88,text:"Visitar Peso da R√©gua"},
    {km:238,text:"Visitar Penacova"},
    {km:619,text:"Visitar Aljustrel"},
    {km:738,text:"Chegar a Faro"}
  ]},

  { items:[
    {km:0,text:"Visitar Chaves"},
    {km:104,text:"Visitar Lamego"},
    {km:248,text:"Visitar Vila Nova de Poiares"},
    {km:640,text:"Visitar Castro Verde"},
    {km:738,text:"Chegar a Faro"}
  ]},

  { items:[
    {km:35,text:"Visitar Vila Pouca de Aguiar"},
    {km:172,text:"Visitar Viseu"},
    {km:271,text:"Visitar G√≥is"},
    {km:551,text:"Visitar Alc√°√ßovas"},
    {km:722,text:"Visitar S√£o Br√°s de Alportel"}
  ]},

  { items:[
    {km:64,text:"Visitar Vila Real"},
    {km:213,text:"Visitar Santa Comba D√£o"},
    {km:345,text:"Visitar Sert√£"},
    {km:565,text:"Visitar Torr√£o"},
    {km:688,text:"Visitar Ameixial"}
  ]},

  { items:[
    {km:81,text:"Visitar Santa Marta de Penagui√£o"},
    {km:225,text:"Visitar Mort√°gua"},
    {km:345,text:"Visitar Sert√£"},
    {km:595,text:"Visitar Ferreira do Alentejo"},
    {km:738,text:"Chegar a Faro"}
  ]},

  { items:[
    {km:88,text:"Visitar Peso da R√©gua"},
    {km:238,text:"Visitar Penacova"},
    {km:366,text:"Visitar Vila de Rei"},
    {km:619,text:"Visitar Aljustrel"},
    {km:738,text:"Chegar a Faro"}
  ]},

  { items:[
    {km:104,text:"Visitar Lamego"},
    {km:248,text:"Visitar Vila Nova de Poiares"},
    {km:386,text:"Visitar Sardoal"},
    {km:640,text:"Visitar Castro Verde"},
    {km:738,text:"Chegar a Faro"}
  ]},

  { items:[
    {km:136,text:"Visitar Castro Daire"},
    {km:260,text:"Visitar Lous√£"},
    {km:430,text:"Visitar Ponte de S√¥r"},
    {km:666,text:"Passar pelo Km 666"},
    {km:738,text:"Chegar a Faro"}
  ]},

  { items:[
    {km:0,text:"Partir de Chaves"},
    {km:369,text:"Chegar ao Meio da Estrada"},
    {km:738,text:"Chegar a Faro"}
  ]},

  { items:[
    {km:69,text:"Passar pelo Km 69"},
    {km:369,text:"Chegar ao Meio da Estrada"},
    {km:476,text:"Visitar Mora"},
    {km:494,text:"Visitar Coruche"},
    {km:738,text:"Chegar a Faro"}
  ]}
];

/* ================= VARI√ÅVEIS ================= */
const pawns=[pawn0,pawn1,pawn2,pawn3];
let players=[],current=0;

/* ================= POSICIONAR PE√ÉO ================= */
function placePawn(pawn,i){
 const s=SPACES[i];
 pawn.style.left=(s.x*board.clientWidth)+"px";
 pawn.style.top =(s.y*board.clientHeight)+"px";
}

/* ================= MODAL ================= */
function showModal(text,buttons){
 modalText.textContent=text;
 modalButtons.innerHTML="";
 buttons.forEach(b=>{
  const btn=document.createElement("button");
  btn.textContent=b.text;
  btn.className=b.cls||"";
  btn.onclick=b.action;
  modalButtons.appendChild(btn);
 });
 modal.style.display="flex";
}
function closeModal(){modal.style.display="none";}

/* ================= SETUP ================= */
startBtn.onclick=()=>{
 setup.classList.add("hidden");
 names.classList.remove("hidden");
 let total=playerCount.value,i=0,used=[];
 function next(){
  names.innerHTML="";
  if(i>=total){
   const deck=[...OBJECTIVES].sort(()=>Math.random()-0.5);
   players.forEach(p=>p.objective=deck.pop());
   names.classList.add("hidden");
   game.classList.remove("hidden");
   objectivePanel.classList.remove("hidden");
   updateTurn();
   return;
  }
  const input=document.createElement("input");
  input.placeholder="Nome do Jogador";
  names.append("Jogador "+(i+1),document.createElement("br"),input,document.createElement("br"));
  [
   {id:0,cls:"car",txt:"üöó Carro"},
   {id:1,cls:"bike",txt:"üö¥ Bicicleta"},
   {id:2,cls:"moto",txt:"üèçÔ∏è Mota"},
   {id:3,cls:"walk",txt:"üö∂ A p√©"}
  ].forEach(p=>{
   if(used.includes(p.id))return;
   const b=document.createElement("button");
   b.className=p.cls;b.textContent=p.txt;
   b.onclick=()=>{
    used.push(p.id);
    players.push({name:input.value||"Jogador",pawn:p.id,pos:0});
    pawns[p.id].style.display="block";
    placePawn(pawns[p.id],0);
    i++;next();
   };
   names.appendChild(b);
  });
 }
 next();
};

/* ================= TURNO ================= */
function updateTurn(){
 turn.textContent="Vez de "+players[current].name;
 renderObjective(players[current]);
}

/* ================= OBJETIVOS ================= */
function renderObjective(p){
 objectivePanel.innerHTML=`<div class="objective-title">üéØ Objetivo</div>`;
 p.objective.items.forEach(it=>{
  objectivePanel.innerHTML+=`
  <div class="obj-item">
   <div class="marco">Km ${it.km}</div>
   <div>${it.text}</div>
  </div>`;
 });
}

/* ================= JOGAR ================= */
rollBtn.onclick=()=>{
 const r=Math.floor(Math.random()*6)+1;
 dice.textContent=r;
 const p=players[current];
 p.pos=Math.min(p.pos+r,SPACES.length-1);
 placePawn(pawns[p.pawn],p.pos);
 current=(current+1)%players.length;
 updateTurn();
};
</script>

</body>
</html>
