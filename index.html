<!doctype html>
<html lang="pt">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Jogo da EN2 ‚Äî A Grande Travessia de Portugal</title>

<style>
:root{
  --bg:#111;
  --text:#eee;
  --panel:#1c1c1c;
  --accent:#ff9800;
  --grey:#555;
  --green:#2ecc71;
  --red:#e53935;
  --season-overlay:none;
}

body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:Arial, Helvetica, sans-serif;
  overflow-x:hidden;
  position:relative;
}

/* Overlay sazonal */
body::before{
  content:"";
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:0;
  opacity:.12;
  background:var(--season-overlay);
}

h1{
  text-align:center;
  margin:20px 0;
  position:relative;
  z-index:1;
}

/* Layout */
.controls{
  text-align:center;
  margin:20px;
  position:relative;
  z-index:1;
}

.main{
  display:flex;
  justify-content:center;
  gap:24px;
  align-items:flex-start;
  position:relative;
  z-index:1;
}

/* Tabuleiro */
.board-frame{
  width:1000px;
  height:750px;
  position:relative;
  overflow:hidden;
  border-radius:10px;
}
.board-img{
  position:absolute;
  inset:0;
  background:url("https://i.imgur.com/SgYhoY8.png") center/cover no-repeat;
}
.pawn{
  position:absolute;
  transform:translate(-50%,-50%);
  font-size:22px;
  display:none;
}

/* Objetivos */
#objectivePanel{
  width:300px;
  background:var(--panel);
  border-radius:16px;
  padding:12px;
  border:2px dashed #555;
}
.objective-title{
  color:var(--accent);
  font-weight:bold;
  margin-bottom:10px;
}
.obj-item{
  display:flex;
  gap:10px;
  margin-bottom:6px;
}
.marco{
  background:var(--grey);
  color:#fff;
  padding:4px 10px;
  border-radius:8px;
  min-width:64px;
  text-align:center;
  font-weight:bold;
}
.marco.done{background:var(--green)}
.extra-title{
  margin:16px 0 8px;
  text-align:center;
  color:#bbb;
  font-size:13px;
  border-top:1px dashed #444;
  padding-top:8px;
}

/* Bot√µes */
button{
  border:none;
  padding:10px 18px;
  border-radius:10px;
  font-weight:bold;
  cursor:pointer;
}
button:disabled{opacity:.5}
.hidden{display:none}

/* Pe√µes */
.car{background:#e53935;color:#fff}
.bike{background:#fb8c00;color:#fff}
.moto{background:#222;color:#fff}
.walk{background:#2ecc71;color:#000}

/* Modal */
#modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.55);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:10;
}
#modalBox{
  background:#222;
  padding:22px;
  border-radius:14px;
  width:420px;
  text-align:center;
}
#modalBox button{margin:6px}
.accept{background:var(--green);color:#000}
.decline{background:var(--red);color:#fff}
.eventGood{background:#1b5e20;color:#fff}
.eventBad{background:#b71c1c;color:#fff}

/* P√≥dio */
#podium{
  position:fixed;
  inset:0;
  background:#000c;
  display:none;
  overflow:auto;
  padding:40px;
  z-index:20;
}
.podium-box{
  display:flex;
  justify-content:center;
  align-items:flex-end;
  gap:30px;
  margin-bottom:40px;
}
.step{
  width:160px;
  border-radius:14px;
  text-align:center;
  padding:12px;
  color:#000;
}
.gold{background:#f5c400;height:220px}
.silver{background:#ccc;height:180px}
.bronze{background:#c68642;height:150px}
.step .emoji{font-size:30px}
.step .name{font-weight:bold;margin-top:6px}

.cards{
  display:flex;
  gap:20px;
  justify-content:center;
  flex-wrap:wrap;
}
.card{
  background:#1c1c1c;
  border:2px dashed #555;
  border-radius:14px;
  padding:12px;
  width:260px;
}
.stats{
  margin-top:10px;
  font-size:13px;
  color:#ccc;
}
</style>
</head>

<body>

<h1>Jogo da EN2 ‚Äî A Grande Travessia de Portugal</h1>

<div class="main">
  <div class="board-frame" id="board">
    <div class="board-img"></div>
    <div class="pawn" id="pawn0">üöó</div>
    <div class="pawn" id="pawn1">üö¥</div>
    <div class="pawn" id="pawn2">üèçÔ∏è</div>
    <div class="pawn" id="pawn3">üö∂</div>
  </div>
  <div id="objectivePanel" class="hidden"></div>
</div>

<div class="controls">
  <div id="setup">
    Jogadores:
    <select id="playerCount">
      <option>1</option><option>2</option><option>3</option><option>4</option>
    </select>

    <p style="margin:14px 0 6px">Quando queres fazer a EN2?</p>
    <label><input type="radio" name="season" value="primavera"> Primavera</label>
    <label><input type="radio" name="season" value="verao"> Ver√£o</label>
    <label><input type="radio" name="season" value="outono"> Outono</label>
    <label><input type="radio" name="season" value="inverno"> Inverno</label>
    <br><br>
    <button id="startBtn">COME√áAR</button>
  </div>

  <div id="names" class="hidden"></div>

  <div id="game" class="hidden">
    <button id="rollBtn">JOGAR</button>
    üé≤ <span id="dice">‚Äî</span>
    <p id="turn"></p>
  </div>
</div>

<div id="modal">
  <div id="modalBox">
    <p id="modalText"></p>
    <div id="modalButtons"></div>
  </div>
</div>

<div id="podium"></div>

<script>
/* ================= ESTA√á√ïES ================= */
const SEASON_OVERLAYS={
  primavera:[
    "radial-gradient(circle at top left, rgba(120,200,120,.6), transparent 60%)",
    "linear-gradient(135deg, rgba(140,220,160,.5), transparent 70%)"
  ],
  verao:[
    "radial-gradient(circle at top, rgba(255,200,80,.7), transparent 60%)",
    "linear-gradient(135deg, rgba(255,170,60,.6), transparent 70%)"
  ],
  outono:[
    "radial-gradient(circle at center, rgba(180,120,60,.6), transparent 65%)",
    "linear-gradient(45deg, rgba(160,90,40,.6), transparent 70%)"
  ],
  inverno:[
    "radial-gradient(circle at top, rgba(140,180,220,.6), transparent 65%)",
    "linear-gradient(180deg, rgba(180,200,220,.6), transparent 70%)"
  ]
};

/* ================= SPACES (REAIS) ================= */
/* ‚ö†Ô∏è ESTES S√ÉO OS TEUS SPACES COMPLETOS */
const OBJECTIVES = [

  { items:[
    {km:0,text:"Visitar Chaves"},
    {km:88,text:"Visitar Peso da R√©gua"},
    {km:238,text:"Visitar Penacova"},
    {km:619,text:"Visitar Aljustrel"},
    {km:738,text:"Chegar a Faro"}
  ]},

  { items:[
    {km:0,text:"Visitar Chaves"},
    {km:104,text:"Visitar Lamego"},
    {km:248,text:"Visitar Vila Nova de Poiares"},
    {km:640,text:"Visitar Castro Verde"},
    {km:738,text:"Chegar a Faro"}
  ]},

  { items:[
    {km:35,text:"Visitar Vila Pouca de Aguiar"},
    {km:172,text:"Visitar Viseu"},
    {km:271,text:"Visitar G√≥is"},
    {km:551,text:"Visitar Alc√°√ßovas"},
    {km:722,text:"Visitar S√£o Br√°s de Alportel"}
  ]},

  { items:[
    {km:64,text:"Visitar Vila Real"},
    {km:213,text:"Visitar Santa Comba D√£o"},
    {km:345,text:"Visitar Sert√£"},
    {km:565,text:"Visitar Torr√£o"},
    {km:688,text:"Visitar Ameixial"}
  ]},

  { items:[
    {km:81,text:"Visitar Santa Marta de Penagui√£o"},
    {km:225,text:"Visitar Mort√°gua"},
    {km:345,text:"Visitar Sert√£"},
    {km:595,text:"Visitar Ferreira do Alentejo"},
    {km:738,text:"Chegar a Faro"}
  ]},

  { items:[
    {km:88,text:"Visitar Peso da R√©gua"},
    {km:238,text:"Visitar Penacova"},
    {km:366,text:"Visitar Vila de Rei"},
    {km:619,text:"Visitar Aljustrel"},
    {km:738,text:"Chegar a Faro"}
  ]},

  { items:[
    {km:104,text:"Visitar Lamego"},
    {km:248,text:"Visitar Vila Nova de Poiares"},
    {km:386,text:"Visitar Sardoal"},
    {km:640,text:"Visitar Castro Verde"},
    {km:738,text:"Chegar a Faro"}
  ]},

  { items:[
    {km:136,text:"Visitar Castro Daire"},
    {km:260,text:"Visitar Lous√£"},
    {km:430,text:"Visitar Ponte de S√¥r"},
    {km:666,text:"Passar pelo Km 666"},
    {km:738,text:"Chegar a Faro"}
  ]},

  { items:[
    {km:0,text:"Partir de Chaves"},
    {km:369,text:"Chegar ao Meio da Estrada"},
    {km:738,text:"Chegar a Faro"}
  ]},

  { items:[
    {km:69,text:"Passar pelo Km 69"},
    {km:369,text:"Chegar ao Meio da Estrada"},
    {km:476,text:"Visitar Mora"},
    {km:494,text:"Visitar Coruche"},
    {km:738,text:"Chegar a Faro"}
  ]}
];

/* ================= MUNIC√çPIOS (NOMES CORRETOS) ================= */
const MUNICIPIO_NOME={
  0:"Chaves",
  35:"Vila Pouca de Aguiar",
  64:"Vila Real",
  69:"Km 69",
  81:"Santa Marta de Penagui√£o",
  88:"Peso da R√©gua",
  104:"Lamego",
  136:"Castro Daire",
  152:"S√£o Pedro do Sul",
  172:"Viseu",
  200:"Tondela",
  213:"Santa Comba D√£o",
  225:"Mort√°gua",
  238:"Penacova",
  248:"Vila Nova de Poiares",
  260:"Lous√£",
  271:"G√≥is",
  317:"Pedr√≥g√£o Grande",
  345:"Sert√£",
  366:"Vila de Rei",
  369:"Meio da Estrada",
  386:"Sardoal",
  400:"Abrantes",
  430:"Ponte de S√¥r",
  466:"Avis",
  476:"Mora",
  494:"Coruche",
  500:"Ciborro",
  518:"Montemor-o-Novo",
  551:"Alc√°√ßovas",
  565:"Torr√£o",
  595:"Ferreira do Alentejo",
  619:"Aljustrel",
  640:"Castro Verde",
  663:"Almod√¥var",
  666:"Km 666",
  688:"Ameixial (Loul√©)",
  722:"S√£o Br√°s de Alportel",
  738:"Faro",
  738.5:"Faro (Final)"
};

/* ================= OBJECTIVOS (OS TEUS) ================= */
const OBJECTIVES=[
 {type:"first"},
 {items:[{km:0},{km:200},{km:400},{km:500},{km:738}]},
 {items:[{km:35},{km:172},{km:271},{km:551},{km:722}]},
 {items:[{km:64},{km:213},{km:345},{km:565},{km:688}]},
 {items:[{km:152},{km:317},{km:466},{km:518},{km:663}]},
 {type:"last"},
 {items:[{km:81},{km:225},{km:345},{km:595},{km:738}]},
 {items:[{km:88},{km:238},{km:366},{km:619},{km:738.5}]},
 {items:[{km:104},{km:248},{km:386},{km:640},{km:738}]},
 {items:[{km:136},{km:260},{km:430},{km:666},{km:738.5}]},
 {items:[{km:0},{km:369},{km:738},{km:738.5}]},
 {items:[{km:0},{km:738}]},
 {items:[{km:69},{km:369},{km:476},{km:494},{km:738}]}
];

/* ================= VARI√ÅVEIS DE JOGO ================= */
const pawns=[pawn0,pawn1,pawn2,pawn3];
let players=[],current=0;

/* ================= POSICIONAR PE√ÉO ================= */
function placePawn(pawn,i){
  const s=SPACES[i];
  pawn.style.left=(s.x*board.clientWidth)+"px";
  pawn.style.top =(s.y*board.clientHeight)+"px";
}

/* ================= MODAL ================= */
function showModal(text,buttons){
  modalText.textContent=text;
  modalButtons.innerHTML="";
  buttons.forEach(b=>{
    const btn=document.createElement("button");
    btn.textContent=b.text;
    btn.className=b.cls||"";
    btn.onclick=b.action;
    modalButtons.appendChild(btn);
  });
  modal.style.display="flex";
}
function closeModal(){modal.style.display="none";}

/* ================= SETUP ================= */
startBtn.onclick=()=>{
  const season=document.querySelector("input[name='season']:checked");
  if(!season){
    alert("Escolhe a esta√ß√£o do ano üåç");
    return;
  }
  const o=SEASON_OVERLAYS[season.value];
  document.body.style.setProperty("--season-overlay",o[Math.floor(Math.random()*o.length)]);

  setup.classList.add("hidden");
  names.classList.remove("hidden");

  const total=Number(playerCount.value);
  let i=0,used=[];
  const deck=[...OBJECTIVES].sort(()=>Math.random()-0.5);

  function next(){
    names.innerHTML="";
    if(i>=total){
      players.forEach(p=>p.objective=deck.pop());
      names.classList.add("hidden");
      game.classList.remove("hidden");
      objectivePanel.classList.remove("hidden");
      updateTurn();
      return;
    }

    const input=document.createElement("input");
    input.placeholder="Nome do Jogador";

    names.append("Jogador "+(i+1),document.createElement("br"),input,document.createElement("br"));

    [
      {id:0,cls:"car",txt:"üöó Carro"},
      {id:1,cls:"bike",txt:"üö¥ Bicicleta"},
      {id:2,cls:"moto",txt:"üèçÔ∏è Mota"},
      {id:3,cls:"walk",txt:"üö∂ A p√©"}
    ].forEach(p=>{
      if(used.includes(p.id))return;
      const b=document.createElement("button");
      b.className=p.cls;
      b.textContent=p.txt;
      b.onclick=()=>{
        used.push(p.id);
        players.push({
          name:input.value||("Jogador "+(i+1)),
          pawn:p.id,
          pos:0,
          done:{},
          finished:false,
          order:0
        });
        pawns[p.id].style.display="block";
        placePawn(pawns[p.id],0);
        i++;next();
      };
      names.appendChild(b);
    });
  }
  next();
};

/* ================= TURNO ================= */
function updateTurn(){
  turn.textContent="Vez de "+players[current].name;
  renderObjective(players[current]);
}

/* ================= OBJETIVO ================= */
function renderObjective(p){
  objectivePanel.innerHTML=`<div class="objective-title">üéØ Objetivo de ${p.name}</div>`;
  if(p.objective.type==="first"){
    objectivePanel.innerHTML+=`<p>Ser o <b>primeiro</b> a chegar a Faro (Km 738,5)</p>`;
    return;
  }
  if(p.objective.type==="last"){
    objectivePanel.innerHTML+=`<p>Ser o <b>√∫ltimo</b> a chegar a Faro (Km 738,5)</p>`;
    return;
  }
  p.objective.items.forEach(it=>{
    objectivePanel.innerHTML+=`
      <div class="obj-item">
        <div class="marco ${p.done[it.km]?"done":""}">Km ${it.km}</div>
        <div>${MUNICIPIO_NOME[it.km]}</div>
      </div>`;
  });
}

/* ================= JOGAR ================= */
rollBtn.onclick=async()=>{
  rollBtn.disabled=true;
  const r=Math.floor(Math.random()*6)+1;
  dice.textContent=r;

  const p=players[current];
  let target=Math.min(p.pos+r,SPACES.length-1);

  while(p.pos!==target){
    p.pos++;
    placePawn(pawns[p.pawn],p.pos);
    await new Promise(res=>setTimeout(res,450));
  }

  current=(current+1)%players.length;
  updateTurn();
  rollBtn.disabled=false;
};
</script>

</body>
</html>
