<!doctype html>
<html lang="pt">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Jogo da EN2 ‚Äî A Grande Travessia de Portugal</title>

<style>
:root{
  --bg:#111;
  --text:#eee;
  --accent:#f5c400;
  --panel:#1c1c1c;
  --grey:#666;
  --green:#2ecc71;
}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:Arial,Helvetica,sans-serif;
}
h1{text-align:center;margin:20px 0;}

.main{
  display:flex;
  justify-content:center;
  gap:24px;
}

.board-frame{
  width:1000px;
  height:750px;
  position:relative;
  overflow:hidden;
  border-radius:10px;
}
.board-img{
  position:absolute;
  inset:0;
  background:url("https://i.imgur.com/SgYhoY8.png") center/cover no-repeat;
}

.pawn{
  position:absolute;
  transform:translate(-50%,-50%);
  font-size:22px;
  pointer-events:none;
  display:none;
}

.controls{text-align:center;margin:20px 0;}
button{
  border:none;
  padding:10px 18px;
  border-radius:10px;
  font-weight:bold;
  cursor:pointer;
}
button:disabled{opacity:.4;cursor:not-allowed}
.hidden{display:none}

/* OBJECTIVO */
#objectivePanel{
  width:340px;
  background:var(--panel);
  border-radius:16px;
  padding:16px;
  border:2px dashed #555;
}
.objective-title{
  font-weight:bold;
  color:#ff9800;
  margin-bottom:12px;
}
.obj-list{
  display:flex;
  flex-direction:column;
  gap:10px;
}
.obj-item{
  display:flex;
  align-items:center;
  gap:12px;
}
.marco{
  padding:6px 10px;
  border-radius:10px;
  background:var(--grey);
  font-weight:bold;
  color:#111;
}
.marco.done{background:var(--green);}

/* PE√ïES */
.pawn.car{color:red}
.pawn.bike{color:orange}
.pawn.moto{color:black}
.pawn.walk{color:lime}

/* SELE√á√ÉO DE PE√ïES */
.pawn-select button{
  margin:6px;
  color:#111;
}
.car{background:red}
.bike{background:orange}
.moto{background:#444;color:#fff}
.walk{background:lime}
</style>
</head>

<body>

<h1>Jogo da EN2 ‚Äî A Grande Travessia de Portugal</h1>

<div class="main">
  <div class="board-frame" id="board">
    <div class="board-img"></div>
    <div class="pawn car" id="pawn0">üöó</div>
    <div class="pawn bike" id="pawn1">üö¥</div>
    <div class="pawn moto" id="pawn2">üèçÔ∏è</div>
    <div class="pawn walk" id="pawn3">üö∂</div>
  </div>

  <div id="objectivePanel" class="hidden"></div>
</div>

<div class="controls">
  <div id="setup">
    Jogadores:
    <select id="playerCount">
      <option>1</option><option>2</option><option>3</option><option>4</option>
    </select>
    <button id="startBtn">COME√áAR</button>
  </div>

  <div id="names" class="hidden"></div>

  <div id="game" class="hidden">
    <button id="rollBtn">JOGAR</button>
    üé≤ <span id="dice">‚Äî</span>
    <p id="turn"></p>
  </div>
</div>

<script>
const SPACES = [...Array(120)].map((_,i)=>({x:0.1+0.007*i,y:0.1+0.006*i}));

const OBJECTIVES=[
 {items:[{km:0,text:"Visitar Chaves"},{km:88,text:"Visitar Peso da R√©gua"},{km:238,text:"Visitar Penacova"},{km:619,text:"Visitar Aljustrel"},{km:738,text:"Chegar a Faro"}]},
 {items:[{km:0,text:"Visitar Chaves"},{km:104,text:"Visitar Lamego"},{km:248,text:"Visitar Vila Nova de Poiares"},{km:640,text:"Visitar Castro Verde"},{km:738,text:"Chegar a Faro"}]},
 {items:[{km:35,text:"Vila Pouca de Aguiar"},{km:172,text:"Viseu"},{km:271,text:"G√≥is"},{km:551,text:"Alc√°√ßovas"},{km:722,text:"S√£o Br√°s de Alportel"}]},
 {items:[{km:64,text:"Vila Real"},{km:213,text:"Santa Comba D√£o"},{km:345,text:"Sert√£"},{km:565,text:"Torr√£o"},{km:688,text:"Ameixial"}]}
];

const KM_TO_INDEX=km=>Math.round((km/738)*(SPACES.length-1));

const pawns=[pawn0,pawn1,pawn2,pawn3];
const pawnData=[
 {id:0,label:"üöó Carro",cls:"car"},
 {id:1,label:"üö¥ Bicicleta",cls:"bike"},
 {id:2,label:"üèçÔ∏è Mota",cls:"moto"},
 {id:3,label:"üö∂ A p√©",cls:"walk"}
];

let players=[];
let current=0;

function placePawn(pawn,i){
 const s=SPACES[i];
 pawn.style.left=(s.x*board.clientWidth)+"px";
 pawn.style.top=(s.y*board.clientHeight)+"px";
}

startBtn.onclick=()=>{
 setup.classList.add("hidden");
 names.classList.remove("hidden");
 names.innerHTML="";
 players=[];
 for(let i=0;i<playerCount.value;i++){
  const div=document.createElement("div");
  const input=document.createElement("input");
  input.placeholder="Nome do Jogador "+(i+1);
  div.appendChild(input);

  const sel=document.createElement("div");
  sel.className="pawn-select";

  pawnData.forEach(p=>{
   const b=document.createElement("button");
   b.textContent=p.label;
   b.className=p.cls;
   b.onclick=()=>{
    b.remove();
    players[i].pawn=p.id;
    pawns[p.id].style.display="block";
    placePawn(pawns[p.id],0);
   };
   sel.appendChild(b);
  });

  names.appendChild(div);
  names.appendChild(sel);

  players.push({name:"",pos:0,finished:false,pawn:null});
 }
 const b=document.createElement("button");
 b.textContent="Confirmar";
 b.onclick=()=>{
  const deck=[...OBJECTIVES].sort(()=>Math.random()-0.5);
  players.forEach((p,i)=>{
   p.name=names.querySelectorAll("input")[i].value||("Jogador "+(i+1));
   p.objective=deck.pop();
  });
  names.classList.add("hidden");
  game.classList.remove("hidden");
  objectivePanel.classList.remove("hidden");
  updateTurn();
 };
 names.appendChild(b);
};

function updateTurn(){
 while(players[current].finished){
  current=(current+1)%players.length;
 }
 turn.textContent="Vez de "+players[current].name;
 renderObjective(players[current]);
}

function renderObjective(p){
 objectivePanel.innerHTML=
 `<div class="objective-title">üéØ Objetivo de ${p.name}</div>
  <div class="obj-list">
   ${p.objective.items.map(it=>{
    const done=p.pos>=KM_TO_INDEX(it.km);
    return `<div class="obj-item">
     <div class="marco ${done?"done":""}">Km ${it.km}</div>
     <div>${it.text}</div>
    </div>`;
   }).join("")}
  </div>`;
}

rollBtn.onclick=async()=>{
 rollBtn.disabled=true;
 const r=Math.floor(Math.random()*6)+1;
 dice.textContent=r;
 const p=players[current];

 let target=p.pos+r;
 if(target>=SPACES.length-1){
  target=(SPACES.length-1)-(target-(SPACES.length-1));
 }

 while(p.pos!==target){
  p.pos+=p.pos<target?1:-1;
  placePawn(pawns[p.pawn],p.pos);
  await new Promise(res=>setTimeout(res,200));
 }

 if(p.pos===SPACES.length-1){
  p.finished=true;
 }

 rollBtn.disabled=false;
 current=(current+1)%players.length;
 updateTurn();
};
</script>

</body>
</html>
