<!doctype html>
<html lang="pt">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Jogo da EN2</title>

<style>
body{margin:0;background:#111;color:#fff;font-family:Arial,Helvetica,sans-serif}
.wrap{display:flex;gap:20px;max-width:1400px;margin:20px auto}
.board{flex:3;position:relative}
.side{flex:1;background:#1c1c1c;border-radius:10px;padding:16px}
h1,h2{margin:0 0 10px}

.board-frame{
  position:relative;
  width:100%;
  aspect-ratio:4/3;
  overflow:hidden;
  border-radius:10px;
  box-shadow:0 0 30px rgba(0,0,0,.7);
}
.zoom{position:absolute;inset:0;transition:.25s ease}
.board-img{
  position:absolute;inset:0;
  background:url('https://i.imgur.com/SgYhoY8.png') center/cover no-repeat;
}

.pawn{
  position:absolute;
  width:22px;height:22px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  transform:translate(-50%,-50%);
  cursor:pointer;font-size:12px;
}
.car{background:#f5c400;color:#111}
.bike{background:#4bb39a}
.motor{background:#ef4a8a}
.person{background:#4267ff}
.selected{outline:2px solid #fff}

.controls{text-align:center;margin-top:12px}
.btn{background:#f5c400;color:#111;border:none;
     padding:10px 18px;border-radius:8px;font-weight:700;cursor:pointer}
.hidden{display:none}

.choice button{
  margin:6px;
  padding:10px 14px;
  font-size:20px;
  border-radius:8px;
  border:none;
  cursor:pointer;
  background:#f5c400;
}
</style>
</head>

<body>
<div class="wrap">

<div class="board">
  <div class="board-frame" id="boardFrame">
    <div class="zoom" id="zoomWrap">
      <div class="board-img"></div>

      <div class="pawn car" id="pawn0">üöó</div>
      <div class="pawn bike" id="pawn1">üö¥</div>
      <div class="pawn motor" id="pawn2">üèçÔ∏è</div>
      <div class="pawn person" id="pawn3">üö∂</div>
    </div>
  </div>

  <div class="controls">
    <div id="setupPlayers">
      Jogadores:
      <select id="playerCount">
        <option>1</option><option>2</option>
        <option>3</option><option>4</option>
      </select>
      <button class="btn" id="startSetup">COME√áAR</button>
    </div>

    <div id="pawnChoice" class="hidden">
      <p id="pawnQuestion"></p>
      <div class="choice" id="pawnButtons"></div>
    </div>

    <div id="gameControls" class="hidden">
      <button class="btn" id="rollBtn">JOGAR</button>
      üé≤ <span id="diceVal">‚Äî</span>
      <p id="turnInfo"></p>
    </div>
  </div>
</div>

<div class="side">
  <h2>Objetivo</h2>
  <div id="objectiveBox">‚Äî</div>
</div>

</div>

<script>
// ===============================
// CASAS
// ===============================
const SPACES = [...${"/* mant√™m-se exatamente como j√° tens */"}];

// ===============================
// OBJETIVOS (13)
// ===============================
const OBJECTIVES = [
{ text:"O teu objectivo √© ser o primeiro a chegar a Faro (Km 738,5)" },
{ text:"Quem disse que o √∫ltimo n√£o pode ganhar?\nSer o √∫ltimo a chegar a Faro (Km 738,5)" },
{ text:"Visitar: Chaves Km 0, Tondela Km 200, Abrantes Km 400, Ciborro Km 500, Faro Km 738" },
{ text:"Visitar: Vila Pouca de Aguiar Km 35, Viseu Km 172, G√≥is Km 271, Alc√°√ßovas Km 551, S. Br√°s de Alportel Km 722" },
{ text:"Visitar: Vila Real Km 64, Sta. Comba D√£o Km 213, Sert√£ Km 345, Torr√£o Km 565, Ameixial Km 688" },
{ text:"Visitar: S√£o Pedro do Sul Km 152, Pedrog√£o Grande Km 317, Avis Km 466, Montemor-o-Novo Km 518, Almod√¥var Km 663" },
{ text:"Visitar: Sta. Marta Penagui√£o Km 81, Mort√°gua Km 225, Sert√£ Km 345, Ferreira do Alentejo Km 595, Faro Km 738" },
{ text:"Visitar: Peso da R√©gua Km 88, Penacova Km 238, Vila de Rei Km 366, Aljustrel Km 619, Faro Km 738,5" },
{ text:"Visitar: Lamego Km 104, Vila Nova de Poiares Km 248, Sardoal Km 386, Castro Verde Km 640, Faro Km 738" },
{ text:"Visitar: Castro Daire Km 136, Lous√£ Km 260, Ponte de S√¥r Km 430, Km 666, Faro Km 738,5" },
{ text:"Visitar: Chaves Km 0, Meio da Estrada Km 369, Faro Km 738, Faro Km 738,5" },
{ text:"Visitar: Chaves Km 0, Faro Km 738" },
{ text:"Visitar: Km 69, Meio da Estrada Km 369, Mora Km 476, Coruche Km 494, Faro Km 738" }
];

// ===============================
// ESTADO
// ===============================
const pawns=[pawn0,pawn1,pawn2,pawn3];
let Game={
  phase:"setup",
  players:[],
  current:0,
  usedPawns:[]
};

// ===============================
// FUN√á√ïES
// ===============================
function placePawn(p,i){
  const s=SPACES[i]; if(!s) return;
  p.style.left=s.x*boardFrame.clientWidth+"px";
  p.style.top=s.y*boardFrame.clientHeight+"px";
}

function zoomTo(x,y,scale=1.4){
  const cx=boardFrame.clientWidth/2;
  const cy=boardFrame.clientHeight/2;
  zoomWrap.style.transform=
    `translate(${(cx-x)*(scale-1)}px,${(cy-y)*(scale-1)}px) scale(${scale})`;
}

async function movePawn(p,steps){
  for(let i=0;i<steps;i++){
    p.pos=Math.min(SPACES.length-1,p.pos+1);
    placePawn(p.el,p.pos);
    const s=SPACES[p.pos];
    zoomTo(s.x*boardFrame.clientWidth,s.y*boardFrame.clientHeight);
    await new Promise(r=>setTimeout(r,300));
  }
}

function nextTurn(){
  Game.current=(Game.current+1)%Game.players.length;
  updateTurn();
}

function updateTurn(){
  turnInfo.textContent="Vez do Jogador "+(Game.current+1);
  objectiveBox.textContent=Game.players[Game.current].objective.text;
}

// ===============================
// SETUP
// ===============================
startSetup.onclick=()=>{
  const n=+playerCount.value;
  Game.players=[];
  Game.usedPawns=[];
  Game.phase="choosePawn";
  setupPlayers.classList.add("hidden");
  pawnChoice.classList.remove("hidden");
  askPawn();
};

function askPawn(){
  pawnQuestion.textContent="Jogador "+(Game.players.length+1)+", como quer viajar?";
  pawnButtons.innerHTML="";
  ["üöó","üö¥","üèçÔ∏è","üö∂"].forEach((icon,i)=>{
    if(!Game.usedPawns.includes(i)){
      const b=document.createElement("button");
      b.textContent=icon;
      b.onclick=()=>choosePawn(i);
      pawnButtons.appendChild(b);
    }
  });
}

function choosePawn(i){
  Game.usedPawns.push(i);
  Game.players.push({
    el:pawns[i],pos:0,
    objective:OBJECTIVES.splice(Math.random()*OBJECTIVES.length|0,1)[0]
  });
  if(Game.players.length==playerCount.value){
    pawnChoice.classList.add("hidden");
    gameControls.classList.remove("hidden");
    Game.phase="play";
    Game.players.forEach(p=>placePawn(p.el,0));
    updateTurn();
  }else askPawn();
}

// ===============================
// JOGO
// ===============================
rollBtn.onclick=async()=>{
  const p=Game.players[Game.current];
  const r=Math.floor(Math.random()*6)+1;
  diceVal.textContent=r;
  await movePawn(p,r);
  nextTurn();
};
</script>
</body>
</html>
