<!doctype html>
<html lang="pt">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Jogo da EN2 ‚Äî A Grande Travessia de Portugal</title>

<style>
:root{
  --bg:#111;
  --accent:#f5c400;
  --text:#fff;
}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:Arial,Helvetica,sans-serif;
}
.wrap{
  max-width:1200px;
  margin:20px auto;
  text-align:center;
}
.board-frame{
  max-width:1000px;
  aspect-ratio:4/3;
  margin:auto;
  position:relative;
  overflow:hidden;
  border-radius:6px;
  box-shadow:0 8px 30px rgba(0,0,0,.6);
}
.zoom{
  position:absolute;
  inset:0;
  transition:transform .35s ease;
}
.board-img{
  position:absolute;
  inset:0;
  background:url("https://i.imgur.com/SgYhoY8.png") center/cover no-repeat;
}

/* PE√ïES */
.pawn{
  position:absolute;
  width:22px;
  height:22px;
  border-radius:50%;
  transform:translate(-50%,-50%);
  font-size:12px;
  display:none;
  align-items:center;
  justify-content:center;
  box-shadow:0 4px 12px rgba(0,0,0,.5);
}
.car{background:#f5c400;color:#111}
.bike{background:#4bb39a}
.motor{background:#ef4a8a}
.person{background:#4267ff}

.controls{
  margin-top:15px;
  display:flex;
  gap:10px;
  justify-content:center;
  align-items:center;
  flex-wrap:wrap;
}
.btn{
  padding:10px 20px;
  border:none;
  border-radius:8px;
  font-weight:bold;
  background:var(--accent);
  cursor:pointer;
}
.help{margin-top:10px;color:#ccc}

#pawnChoice{margin-top:16px}
#pawnButtons{
  display:flex;
  gap:10px;
  justify-content:center;
  flex-wrap:wrap;
}
</style>
</head>

<body>
<div class="wrap">

<h1>JOGO DA EN2 ‚Äî A Grande Travessia de Portugal</h1>

<div class="board-frame" id="boardFrame">
  <div class="zoom" id="zoomWrap">
    <div class="board-img"></div>
    <div class="pawn car" id="pawn0">üöó</div>
    <div class="pawn bike" id="pawn1">üö¥</div>
    <div class="pawn motor" id="pawn2">üèçÔ∏è</div>
    <div class="pawn person" id="pawn3">üö∂</div>
  </div>
</div>

<div class="controls">
  <span id="playersLabel">Jogadores:</span>
  <select id="playerCount">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4" selected>4</option>
  </select>

  <button class="btn" id="startBtn">COME√áAR</button>
  <button class="btn" id="rollBtn" style="display:none">JOGAR</button>

  üé≤ <strong id="diceVal">‚Äî</strong>
  <span id="turnInfo"></span>
</div>

<div id="pawnChoice" style="display:none">
  <p id="pawnQuestion"></p>
  <div id="pawnButtons"></div>
</div>

<div class="help">
  Percorre a EN2 casa a casa.
</div>

</div>

<script>
// ===============================
// POSI√á√ïES DAS CASAS (RESUMO)
// ===============================
// ‚ö†Ô∏è Aqui deves manter a tua lista COMPLETA.
// Para n√£o rebentar a mensagem, mantive funcional.
// Usa a mesma lista que j√° tinhas.
const SPACES = [
  {"x":0.0916530278,"y":0.1137939783},
  {"x":0.0867430441,"y":0.1625084573},
  {"x":0.0867430441,"y":0.2152824763},
  {"x":0.0916530278,"y":0.2700862652},
  {"x":0.1271140207,"y":0.2355801759},
  {"x":0.1505728314,"y":0.1895720568},
  {"x":0.1762138570,"y":0.1435639377},
  {"x":0.2187670485,"y":0.1131173883},
  {"x":0.2651391162,"y":0.0941728687},
  {"x":0.3055100927,"y":0.1022919485},
  {"x":0.3458810692,"y":0.1300321380},
  {"x":0.3595199127,"y":0.1767168470},
  {"x":0.3246044735,"y":0.2159590663},
  {"x":0.2875068194,"y":0.1922784167},
  {"x":0.2427714129,"y":0.1719807171}
];

// ===============================
// ELEMENTOS
// ===============================
const boardFrame = document.getElementById("boardFrame");
const zoomWrap   = document.getElementById("zoomWrap");
const pawns      = [
  document.getElementById("pawn0"),
  document.getElementById("pawn1"),
  document.getElementById("pawn2"),
  document.getElementById("pawn3")
];
const rollBtn    = document.getElementById("rollBtn");
const startBtn   = document.getElementById("startBtn");
const diceVal    = document.getElementById("diceVal");
const turnInfo   = document.getElementById("turnInfo");
const playerSel  = document.getElementById("playerCount");
const playersLabel = document.getElementById("playersLabel");

// ===============================
// ESTADO
// ===============================
let totalPlayers = 0;
let players = []; // { pawn, pos }
let currentPlayer = 0;

// ===============================
// FUN√á√ïES BASE
// ===============================
function placePawn(pawn,i){
  pawn.style.left = SPACES[i].x * boardFrame.clientWidth+"px";
  pawn.style.top  = SPACES[i].y * boardFrame.clientHeight+"px";
}

async function movePawn(playerIndex,steps){
  for(let i=0;i<steps;i++){
    players[playerIndex].pos =
      Math.min(players[playerIndex].pos+1, SPACES.length-1);
    placePawn(
      pawns[players[playerIndex].pawn],
      players[playerIndex].pos
    );
    await new Promise(r=>setTimeout(r,400));
  }
}

// ===============================
// COME√áAR ‚Üí ESCOLHA DE PE√ïES
// ===============================
startBtn.onclick = ()=>{
  totalPlayers = Number(playerSel.value);
  players = [];
  currentPlayer = 0;

  pawns.forEach(p=>p.style.display="none");

  playersLabel.style.display = "none";
  playerSel.style.display = "none";
  startBtn.style.display = "none";

  showPawnChoice();
};

function showPawnChoice(){
  const box = document.getElementById("pawnChoice");
  const q   = document.getElementById("pawnQuestion");
  const btns= document.getElementById("pawnButtons");

  box.style.display = "block";
  btns.innerHTML = "";

  q.textContent = `Jogador ${players.length+1}, como quer viajar?`;

  const icons = ["üöó","üö¥","üèçÔ∏è","üö∂"];

  icons.forEach((icon,i)=>{
    if(players.find(p=>p.pawn===i)) return;

    const b = document.createElement("button");
    b.className="btn";
    b.textContent = icon;

    b.onclick = ()=>{
      players.push({ pawn:i, pos:0 });
      pawns[i].style.display="flex";
      placePawn(pawns[i],0);

      if(players.length < totalPlayers){
        showPawnChoice();
      }else{
        box.style.display="none";
        rollBtn.style.display="inline-block";
        turnInfo.textContent="Vez do Jogador 1";
      }
    };

    btns.appendChild(b);
  });
}

// ===============================
// DADO
// ===============================
rollBtn.onclick = async ()=>{
  const r = Math.floor(Math.random()*6)+1;
  diceVal.textContent = r;

  await movePawn(currentPlayer,r);

  currentPlayer = (currentPlayer+1)%players.length;
  turnInfo.textContent = "Vez do Jogador " + (currentPlayer+1);
};
</script>

</body>
</html>

