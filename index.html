<!doctype html>
<html lang="pt">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Jogo da EN2 ‚Äî A Grande Travessia de Portugal</title>

<style>
:root{
  --bg:#111;
  --accent:#f5c400;
  --text:#fff;
}
html,body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:var(--bg);
  color:var(--text);
}
.wrap{max-width:1200px;margin:20px auto;text-align:center}
h1{margin-bottom:10px}

.board-frame{
  max-width:1000px;
  aspect-ratio:4/3;
  margin:0 auto;
  position:relative;
  overflow:hidden;
  border-radius:6px;
  box-shadow:0 8px 30px rgba(0,0,0,.6);
}
.zoom{
  position:absolute;
  inset:0;
  transform-origin:center center;
  transition:transform .4s ease;
  pointer-events:none;
}
.board-img{
  position:absolute;
  inset:0;
  background:url("https://i.imgur.com/SgYhoY8.png") center/cover no-repeat;
}

.pawn{
  position:absolute;
  width:22px;height:22px;
  border-radius:50%;
  transform:translate(-50%,-50%);
  font-size:12px;
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 4px 12px rgba(0,0,0,.5);
}
.car{background:#f5c400;color:#111}
.bike{background:#4bb39a}
.motor{background:#ef4a8a}
.person{background:#4267ff}
.selected{outline:2px solid #fff}

.controls{margin-top:15px;display:flex;gap:10px;justify-content:center;align-items:center}
.btn{
  background:var(--accent);
  color:#111;
  padding:10px 18px;
  border:none;
  border-radius:8px;
  font-weight:bold;
  cursor:pointer;
}
.help{margin-top:8px;color:#ccc;font-size:14px}

#pawnChoice{margin-top:16px}
#pawnButtons{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
</style>
</head>

<body>
<div class="wrap">
<h1>JOGO DA EN2 ‚Äî A Grande Travessia de Portugal</h1>

<div class="board-frame" id="boardFrame">
  <div class="zoom" id="zoomWrap">
    <div class="board-img"></div>
    <div class="pawn car"    id="pawn0">üöó</div>
    <div class="pawn bike"   id="pawn1">üö¥</div>
    <div class="pawn motor"  id="pawn2">üèçÔ∏è</div>
    <div class="pawn person" id="pawn3">üö∂</div>
  </div>
</div>

<div class="controls">
  <label>Jogadores:</label>
  <select id="playerCount">
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4" selected>4</option>
  </select>

  <button class="btn" id="startBtn">COME√áAR</button>
  <button class="btn" id="rollBtn" style="display:none">JOGAR</button>
  <span>üé≤ <strong id="diceVal">‚Äî</strong></span>
</div>

<div id="pawnChoice" style="display:none">
  <p id="pawnQuestion"></p>
  <div id="pawnButtons"></div>
</div>

<div class="help">
  Lan√ßa o dado e percorre a EN2 casa a casa.
</div>
</div>

<script>
// ===============================
// POSI√á√ïES DAS CASAS (DO PICKER)
// ===============================
const SPACES = [ /* N√ÉO ALTERADO */
  {"x":0.0916530278,"y":0.1137939783},
  {"x":0.0867430442,"y":0.1625084573},
  {"x":0.0867430442,"y":0.2152824763},
  {"x":0.0916530278,"y":0.2700862652},
  {"x":0.1271140207,"y":0.2355801759},
  {"x":0.1505728314,"y":0.1895720568},
  {"x":0.1762138571,"y":0.1435639378},
  {"x":0.2187670486,"y":0.1131173884},
  {"x":0.2651391162,"y":0.0941728687},
  {"x":0.3055100927,"y":0.1022919486},
  {"x":0.3458810693,"y":0.1300321380},
  {"x":0.3595199127,"y":0.1767168471},
  {"x":0.3246044735,"y":0.2159590663},
  {"x":0.2875068194,"y":0.1922784168},
  {"x":0.2427714130,"y":0.1719807172},
  {"x":0.2198581560,"y":0.2179888363},
  {"x":0.2384069831,"y":0.2700862652},
  {"x":0.2280414621,"y":0.3188007442},
  {"x":0.1811238407,"y":0.3269198241},
  {"x":0.1391162029,"y":0.3357154939},
  {"x":0.1129296236,"y":0.3871363329},
  {"x":0.1194762684,"y":0.4372039919},
  {"x":0.1571194763,"y":0.4690037212},
  {"x":0.2002182215,"y":0.4500592016},
  {"x":0.2340425532,"y":0.4121701624},
  {"x":0.2613202400,"y":0.3688684032},
  {"x":0.2940534643,"y":0.3275964141},
  {"x":0.3333333333,"y":0.2998562246},
  {"x":0.3786142935,"y":0.3181241543},
  {"x":0.4026186579,"y":0.3600727334},
  {"x":0.4069830878,"y":0.4196126522},
  {"x":0.3824331697,"y":0.4554719215},
  {"x":0.3376977632,"y":0.4893014208},
  {"x":0.2967812330,"y":0.5048629905},
  {"x":0.2509547190,"y":0.5190713802},
  {"x":0.2040370977,"y":0.5501945196},
  {"x":0.1756683033,"y":0.5887601488},
  {"x":0.1887615930,"y":0.6455937077},
  {"x":0.2334969995,"y":0.6652148173},
  {"x":0.2771412984,"y":0.6516830176},
  {"x":0.3175122750,"y":0.6313853180},
  {"x":0.3595199127,"y":0.6070280785},
  {"x":0.4004364430,"y":0.5725219892},
  {"x":0.4282596836,"y":0.5420754398},
  {"x":0.4653573377,"y":0.5014800406},
  {"x":0.4915439171,"y":0.4676505413},
  {"x":0.5237315876,"y":0.4290849120},
  {"x":0.5613747954,"y":0.4026979026},
  {"x":0.5990180033,"y":0.3634556834},
  {"x":0.6377523186,"y":0.3404516238},
  {"x":0.6824877250,"y":0.3248900541},
  {"x":0.7255864703,"y":0.3363920839},
  {"x":0.7408619749,"y":0.3857831529},
  {"x":0.7097654119,"y":0.4331444520},
  {"x":0.6715766503,"y":0.4635910014},
  {"x":0.6295690125,"y":0.4865950609},
  {"x":0.5881069285,"y":0.5116288904},
  {"x":0.5526459356,"y":0.5434286198},
  {"x":0.5280960175,"y":0.5806410690},
  {"x":0.5302782324,"y":0.6422107578},
  {"x":0.5575559193,"y":0.6861891069},
  {"x":0.5995635570,"y":0.6949847767},
  {"x":0.6415711948,"y":0.6713041272},
  {"x":0.6688488816,"y":0.6246194181},
  {"x":0.6972176759,"y":0.5779347091},
  {"x":0.7299509002,"y":0.5319265900},
  {"x":0.7665030005,"y":0.5068927605},
  {"x":0.8090561920,"y":0.5346329499},
  {"x":0.8199672668,"y":0.5860537889},
  {"x":0.7948717949,"y":0.6408575778},
  {"x":0.7495908347,"y":0.6516830176},
  {"x":0.7054009820,"y":0.6665679973},
  {"x":0.7092198582,"y":0.7132527064},
  {"x":0.7277686852,"y":0.7667033153},
  {"x":0.7026732133,"y":0.8194773342},
  {"x":0.6623022368,"y":0.8012094046},
  {"x":0.6126568467,"y":0.7768521651},
  {"x":0.5859247136,"y":0.8194773342},
  {"x":0.6099290780,"y":0.8688684032},
  {"x":0.6486633933,"y":0.8898426928},
  {"x":0.6912165848,"y":0.8918724628},
  {"x":0.7424986361,"y":0.8715747632},
  {"x":0.7801418440,"y":0.8330091340},
  {"x":0.7997817785,"y":0.7863244249},
  {"x":0.8145117294,"y":0.7396397158},
  {"x":0.8521549373,"y":0.6902486468},
  {"x":0.8696126568,"y":0.7477587957},
  {"x":0.8908892526,"y":0.7897073748},
  {"x":0.9078014184,"y":0.8478941137},
  {"x":0.8979814512,"y":0.9026979026}
];

// ===============================
// ELEMENTOS
// ===============================
const boardFrame = document.getElementById("boardFrame");
const zoomWrap = document.getElementById("zoomWrap");
const pawns = [
  document.getElementById("pawn0"),
  document.getElementById("pawn1"),
  document.getElementById("pawn2"),
  document.getElementById("pawn3")
];
const rollBtn = document.getElementById("rollBtn");
const diceVal = document.getElementById("diceVal");
const startBtn = document.getElementById("startBtn");
const playerSel = document.getElementById("playerCount");

// ===============================
// ESTADO
// ===============================
let players = [];
let currentPlayer = 0;
let pawnPos = [0,0,0,0];

// ===============================
// FUN√á√ïES
// ===============================
function placePawn(pawn,i){
  const s = SPACES[i];
  pawn.style.left = s.x*boardFrame.clientWidth+"px";
  pawn.style.top  = s.y*boardFrame.clientHeight+"px";
}

function zoomTo(x,y,scale){
  const cx = boardFrame.clientWidth/2;
  const cy = boardFrame.clientHeight/2;
  zoomWrap.style.transform =
    `translate(${(cx-x)*(scale-1)}px,${(cy-y)*(scale-1)}px) scale(${scale})`;
}

async function movePawn(id,steps){
  for(let i=0;i<steps;i++){
    pawnPos[id]++;
    placePawn(pawns[id],pawnPos[id]);
    const s = SPACES[pawnPos[id]];
    zoomTo(s.x*boardFrame.clientWidth,s.y*boardFrame.clientHeight,1.5);
    await new Promise(r=>setTimeout(r,400));
  }
}

// ===============================
// SETUP JOGADORES
// ===============================
startBtn.onclick = ()=>{
  const count = Number(playerSel.value);
  players=[];
  pawnPos=[0,0,0,0];
  pawns.forEach(p=>p.style.display="none");
  currentPlayer=0;
  showPawnChoice(count);
};

function showPawnChoice(count){
  const box=document.getElementById("pawnChoice");
  const q=document.getElementById("pawnQuestion");
  const btns=document.getElementById("pawnButtons");
  box.style.display="block";
  btns.innerHTML="";
  q.textContent=`Jogador ${currentPlayer+1}, como quer viajar?`;

  ["üöó","üö¥","üèçÔ∏è","üö∂"].forEach((e,i)=>{
    if(players.find(p=>p===i))return;
    const b=document.createElement("button");
    b.className="btn";
    b.textContent=e;
    b.onclick=()=>{
      players.push(i);
      pawns[i].style.display="flex";
      placePawn(pawns[i],0);
      currentPlayer++;
      if(currentPlayer<count) showPawnChoice(count);
      else{
        box.style.display="none";
        rollBtn.style.display="inline-block";
        currentPlayer=0;
      }
    };
    btns.appendChild(b);
  });
}

// ===============================
// DADO
// ===============================
rollBtn.onclick=async()=>{
  const r=Math.floor(Math.random()*6)+1;
  diceVal.textContent=r;
  await movePawn(players[currentPlayer],r);
  currentPlayer=(currentPlayer+1)%players.length;
};

// INIT
pawns.forEach((p,i)=>placePawn(p,0));
</script>
</body>
</html>
